<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at 2015-04-05 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keywords" content="jmx, rest, json, http, agent, jmx-rest-bridge, java, jmx4perl, jsr-160, jmx-rest"/>
    <title>Jolokia &#x2013; Tutorial</title>
    <style type="text/css" media="all">
      @import url("./css/reset.css");
      @import url("./css/text.css");
      @import url("./css/960_24_col.css");
      @import url("./css/maven-base.css");
      @import url("./css/prettify.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <script data-cfasync="false" type="text/javascript">
       var host = "jolokia.org";
       if ((host == window.location.host) && (window.location.protocol != "https:")) {
            window.location.protocol = "https";
       }
    </script>
    <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9534565-3']);
  _gaq.push(['_setDomainName', '.jolokia.org']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
    </script>
    <script type="text/javascript" src="./js/prettify/prettify.js"></script>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <link rel="icon" type="image/png" href="./images/favicon.png" />
      <meta name="author" content="Roland Huss" />
    <meta name="Date-Revision-yyyymmdd" content="20150405" />
    <meta http-equiv="Content-Language" content="en" />
     
  </head>
  <body class="composite" onload="prettyPrint()">
    <div class="container_24">

      <!-- Header -->
      <div class="grid_24 header">
        <div></div>
      </div>
      <div class="clear"></div>

      <!-- Top-Bar  -->
      <div class="grid_24 top_bar">
          <div class="top_left"></div>
      <div class="top_link">
        <a href="index.html">Home</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="download.html">Download</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="features-nb.html">Features</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="documentation.html">Documentation</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="support.html">Support</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="https://ro14nd.de">Blog</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="about.html">About</a>
    </div>
    <div class="top_sep"></div>
        </div>
      <div class="clear"></div>

      <!-- Main-Box  -->
      <div class="grid_24 main_box">
        <!-- Main-Top -->
        <div class="grid_24 alpha main_top"></div>
        <div class="grid_24 alpha main_content">
          <!-- Navigation -->
          <div class="grid_5 alpha">
                  <div class="navibox">
          <div class="navihead">
             <h5>Jolokia</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="download.html" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="features-nb.html" title="Features">Features</a>
            </li>
                  <li class="none">
                          <a href="support.html" title="Support">Support</a>
            </li>
                  <li class="none">
                          <a href="forum.html" title="Forum">Forum</a>
            </li>
                  <li class="none">
                          <a href="irc.html" title="IRC">IRC</a>
            </li>
                  <li class="none">
                          <a href="license.html" title="License">License</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Documentation</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="documentation.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
            <strong>Tutorial</strong>
          </li>
                  <li class="none">
                          <a href="reference/html/index.html" title="Reference Manual">Reference Manual</a>
            </li>
                  <li class="none">
                          <a href="talks.html" title="Talks and Screencasts">Talks and Screencasts</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Agents</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="agent.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="agent/war.html" title="Web Archive (war)">Web Archive (war)</a>
            </li>
                  <li class="none">
                          <a href="agent/osgi.html" title="Osgi">Osgi</a>
            </li>
                  <li class="none">
                          <a href="agent/jvm.html" title="JVM">JVM</a>
            </li>
                  <li class="none">
                          <a href="agent/mule.html" title="Mule">Mule</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Clients</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="client/java.html" title="Java">Java</a>
            </li>
                  <li class="none">
                          <a href="client/javascript.html" title="Javascript">Javascript</a>
            </li>
                  <li class="none">
                          <a href="client/perl.html" title="Perl">Perl</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Project Documentation</h5>
            </div>    
            <div class="naviitems">
    <ul>
                                                                                                                                                              <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
    </div>
      </div>
            </div>
          <!-- Main Box -->
          <div class="grid_18 omega">
            <div class="content_box grid_18 alpha">
              <div class="content_top_bg content_top grid_18 alpha"></div>
              <div class="content_content_bg content_content grid_18">
                <!-- ~ Copyright 2009-2013 Roland Huss
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~       http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License. -->
  
  
    <div class="section">
<h2><a name="a5_Minute_Quickstart"></a>5 Minute Quickstart</h2>
      
<p>
        In this tutorial, it will be demonstrated how easily a WAR agent
        can be installed on a fresh Tomcat, how to verify the
        installation and how to access the client.      
      </p>
      
<div class="section">
<h3><a name="Preparation"></a>Preparation</h3>
        
<p>
          In order to start on a green field, we are installing a
          fresh Tomcat in which the agent-war is going to be
          installed. Download Tomcat 7 from its <a class="externalLink" href="http://tomcat.apache.org/download-70.cgi">site</a> and
          extract it:
        </p>
        
<div>
<pre>
$ tar zxvf apache-tomcat-7.*.tar.gz 
$ cd apache-tomcat-7.*
$ TC=`pwd`</pre></div>
        
<p>
          Download the Jolokia WAR-agent and copy it into Tomcat's
          webapp directory:
        </p>
        
<div>
<pre>
$ cd $TC/webapps
$ wget \ 
http://repo1.maven.org/maven2/org/jolokia/jolokia-war/1.2.3/jolokia-war-1.2.3.war
$ mv jolokia-war-1.2.3.war jolokia.war</pre></div>
      </div>
      
<div class="section">
<h3><a name="Startup_and_Verification"></a>Startup and Verification</h3>
        
<p>
          Now the container can be started with:
        </p>
        
<div>
<pre class="prettyprint">
$ $TC/bin/catalina.sh start</pre></div>
        
<p>
          In order to verify the installation, point your browser to 
        </p>
        
<div>
<pre>http://localhost:8080/jolokia/version</pre></div>
        
<p>
          which should show up something like
        </p>
        
<div align="center">
          <img src="images/jolokia_browser_version.png" style="margin: 10px 0px 20px 0px;" alt="Show up version" />
        </div>        
      </div>
      
<div class="section">
<h3><a name="A_simple_Java_Client"></a>A simple Java Client</h3>
        
<p>
          Let's try out the client side of Jolokia. This example will
          print out the memory usage of your tomcat:
        </p>
        
<div>
<pre class="prettyprint">
import org.jolokia.client.*;
import org.jolokia.client.request.*;
import java.util.Map;

public class JolokiaDemo {
    
    public static void main(String[] args) throws Exception {
        J4pClient j4pClient = new J4pClient(&quot;http://localhost:8080/jolokia&quot;);
        J4pReadRequest req = new J4pReadRequest(&quot;java.lang:type=Memory&quot;,
                                                &quot;HeapMemoryUsage&quot;);
        J4pReadResponse resp = j4pClient.execute(req);
        Map&lt;String,String&gt; vals = resp.getValue();
        int used = Integer.parseInt(vals.get(&quot;used&quot;));
        int max = Integer.parseInt(vals.get(&quot;max&quot;));
        int usage = (int) (used * 100 / max);
        System.out.println(&quot;Memory usage: used: &quot; + used + 
                           &quot; / max: &quot; + max + &quot; = &quot; + usage + &quot;%&quot;);
    }
}</pre></div>
        
<p>
          Save this code-snippet under
          <tt>JolokiaDemo.java</tt>. Then download 
        </p>
        
<ul>
          
<li>
            <a class="externalLink" href="http://repo1.maven.org/maven2/org/jolokia/jolokia-client-java/1.2.3/jolokia-client-java-1.2.3.jar">jolokia-client-java-1.0.0.jar</a>
          </li>
          
<li>
            <a class="externalLink" href="http://mirrors.ibiblio.org/pub/mirrors/maven2/com/googlecode/json-simple/json-simple/1.1/json-simple-1.1.jar">
            json-simple</a>
          </li>
          
<li>
            <a class="externalLink" href="http://mirrors.ibiblio.org/pub/mirrors/maven2/org/apache/httpcomponents/httpclient/4.1.2/httpclient-4.1.2.jar">httpclient-4.1.2.jar</a>
          </li>
          
<li>
            <a class="externalLink" href="http://mirrors.ibiblio.org/pub/mirrors/maven2/org/apache/httpcomponents/httpcore/4.1.2/httpcore-4.1.2.jar">httpcore-4.1.2.jar</a>
          </li>
          
<li>
            <a class="externalLink" href="http://mirrors.ibiblio.org/pub/mirrors/maven2/commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar">commons-logging-1.1.1.jar</a>
          </li>
        </ul>
        
<p>
          and put it into the same directory as this demo
          class. Finally, compile the demo and let it run:
        </p>
        
<div>
<pre class="prettyprint lang-bash">
$ export CLASSPATH=json_simple-1.1.jar:jolokia-client-java-1.0.0.jar:\
httpcore-4.1.2.jar:httpclient-4.1.2.jar:commons-logging-1.1.1.jar:.

$ javac JolokiaDemo.java
$ java JolokiaDemo
Memory usage: used: 9526648 / max: 129957888 = 7%
</pre></div>
        
<p>
          If you are using Maven, please don't worry about the
          dependencies which just have been downloaded manually for the
          sake of demonstration. Jolokia's Java client library comes
          with a well defined dependency set, so Maven will do the
          magic. (In fact, the client library only depends on
          jsons-simple and http-components directly)
        </p>
      </div>
      
<div class="section">
<h3><a name="Install_Jmx4Perl"></a>Install Jmx4Perl</h3>
        
<p>
          The five minutes are probably over now, but I highly
          recommend to install <a class="externalLink" href="http://www.jmx4perl.org">jmx4perl</a> right
          now. Beside providing a Perl language binding for Jolokia,
          there are some cool command line tools included which are
          useful on their own.
        </p>
        
<ul>
          
<li>
            <b>jmx4perl</b> is a command for exploring the
            JMX space by providing arguments on the command line.
          </li>
          
<li>
            <b>j4psh</b> is a readline based, colored,
            interactive shell with context sensitive command
            completion on MBean names and attributes/operations. It
            is a perfect tool for interactively exploring MBeans and
            their values.
          </li>
          
<li>
            <b>check_jmx4perl</b> is a feature reach Nagios
            plugin for connecting the Jolokia agent with Nagios.
          </li>
          
<li>
            <b>jolokia</b> is a supporting script for easy 
            download and configuration of the Jolokia agents.
          </li>
        </ul>
        
<p>
          <tt>jmx4perl</tt> (and its dependencies) can be easily
          installed with <tt>cpan</tt> if you have Perl installed:
        </p>
        
<div>
<pre>
$ perl -MCPAN -e shell
Terminal does not support AddHistory.

cpan shell -- CPAN exploration and modules installation (v1.9205)
ReadLine support available (maybe install Bundle::CPAN or Bundle::CPANxxl?)

cpan[1]&gt; install JMX::Jmx4Perl
...
...
jmx4perl
========

jmx4perl is a command line utility for accessing Jolokia agents
(www.jolokia.org). It can be used for script based exploration 
and easy inspection of the JMX space.

Install 'jmx4perl' ? (y/n) [y ]
....
</pre></div>
        
<p>
          You will be asked for each featured script whether it should
          be installed in addition to the core Perl modules. Each of
          these scripts (jmx4perl, j4psh, jolokia, check_jmx4perl) will
          introduce a set of new depedencies of Perl modules which in
          turn might depend on other Perl modules or system
          libraries. Perl modules are resolved and installed
          automatically. The agent management script
          <tt>jolokia</tt> depends on <tt>XML::LibXML</tt>
          which requires a development version of <tt>libxml</tt>
          installed locally. It is recommended to install
          <tt>libxml2-dev</tt> with the package management tool of
          your OS (e.g. <tt>apt-get install libxml2-dev</tt>
          ). Alternatively, the OS package for XML::LibXML could be
          used. (e.g. <tt>libxml-libxml-perl</tt> for
          Ubuntu)
        </p>
        
<p>
          When jmx4perl is installed, try out jmx4perl:
        </p>
        
<div>
<pre>
$ jmx4perl http://localhost:8080/jolokia list
....
$ jmx4perl http://localhost:8080/jolokia \
           read java.lang:type=Memory HeapMemoryUsage
$ jmx4perl --help
$ man jmx4perl</pre></div>
        
<p>
          Next, I recommend to try out <tt>j4psh</tt>.  For
          getting the best readline experience, it is recommended to
          also install <tt>Term::ReadLine::Gnu</tt> (which in turn
          requires the package <tt>libreadline-dev</tt> to be
          installed), but this is optional. Now, fire up j4psh and let
          the fun begin:
        </p>
        
<div align="center">
          <img src="images/j4psh_screenshot.png" alt="j4psh screenshot" />
        </div>
        
<p>
          Don't forget to try out TAB triggered command and argument
          completion as demonstrated in this <a class="externalLink" href="http://vimeo.com/20215477">screencast</a>.
        </p>
      </div>
      
<div class="section">
<h3><a name="Summary"></a>Summary</h3>
        
<p>
          That's all for now, I hope you enjoyed this first ride. For
          the next steps I recommend to have a look into <a href="reference/html/index.html">reference manual</a>.
        </p>
      </div>
    </div>
  

              </div>
              <div class="content_bottom_bg content_bottom grid_18 omega"></div>
            </div>
          </div>
          <div class="grid_24 alpha">
            <div class="copyright_footer">Copyright &#169;                   2015 Roland Hu&szlig;. 
          All Rights Reserved.      
                
                 <span id="publishDate">Last Published: 2015-04-05</span>
              &nbsp;| <span id="projectVersion">Version: 1.2.4-SNAPSHOT</span>
            </div>
          </div>
          <div class="clear"></div>
        </div>
        <!-- Main Bottom -->
        <div class="grid_24 alpha main_bottom"></div>        
      </div>
    </div>
  </body>
</html>
  
