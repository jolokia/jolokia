<!DOCTYPE html>
<!-- Generated by Apache Maven Doxia at 2024-12-04 -->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="keywords" content="jmx, rest, json, http, agent, jmx-rest-bridge, java, jmx4perl, jsr-160, jmx-rest">
  <title>    Jolokia &#x2013; Agents                                                          </title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap">
  <style media="all">
    @import url("./css/reset.css");
    @import url("./css/text.css");
    @import url("./css/maven-theme-jolokia.css");
    @import url("./css/site.css");
  </style>
  <script data-cfasync="false">
    let host = "jolokia.org";
      if ((host === window.location.host) && (window.location.protocol !== "https:")) {
        window.location.protocol = "https";
      }
  </script>
  <script src="./js/prettify/prettify.js"></script>
  <link rel="stylesheet" href="./css/print.css" media="print">
  <link rel="icon" type="image/png" href="./images/favicon.png">
  <meta name="Date-Creation-yyyymmdd" content="20241204" />
  <meta name="Date-Revision-yyyymmdd" content="20241204" />
  <meta http-equiv="Content-Language" content="en" />
  
</head>
<body>
<div class="container">
  <!-- Header -->
  <div class="header">
    <div class="header-image"></div>
  </div>

  <!-- Top-Bar  -->
  <nav class="header">
      <div class="top_left"></div>
      <div class="top_link">
        <a href="index.html">Home</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="download.html">Download</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="features.html">Features</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="documentation.html">Documentation</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="support.html">Support</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="https://ro14nd.de">Blog</a>
    </div>
    <div class="top_sep"></div>
      <div class="top_link">
        <a href="about.html">About</a>
    </div>
    <div class="top_sep"></div>
    </nav>

  <main>
    <nav class="menu">
            <div class="navibox">
          <div class="navihead">
             <h5>Jolokia</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="download.html" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="libraries.html" title="Libraries">Libraries</a>
            </li>
                  <li class="none">
                          <a href="migration.html" title="Migration to 2.0">Migration to 2.0</a>
            </li>
                  <li class="none">
                          <a href="features.html" title="Features">Features</a>
            </li>
                  <li class="none">
                          <a href="support.html" title="Support">Support</a>
            </li>
                  <li class="none">
                          <a href="license.html" title="License">License</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Documentation</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="documentation.html" title="Overview">Overview</a>
            </li>
                  <li class="none">
                          <a href="concepts.html" title="Concepts">Concepts</a>
            </li>
                  <li class="none">
                          <a href="tutorial.html" title="Tutorial">Tutorial</a>
            </li>
                  <li class="none">
                          <a href="reference/html/index.html" title="Reference Manual">Reference Manual</a>
            </li>
                  <li class="none">
                          <a href="talks.html" title="Talks and Screencasts">Talks and Screencasts</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Agents</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
            <strong>Overview</strong>
          </li>
                  <li class="none">
                          <a href="agent/war.html" title="Web Archive (war)">Web Archive (war)</a>
            </li>
                  <li class="none">
                          <a href="agent/osgi.html" title="Osgi">Osgi</a>
            </li>
                  <li class="none">
                          <a href="agent/jvm.html" title="JVM">JVM</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Clients</h5>
            </div>    
            <div class="naviitems">
    <ul>
                  <li class="none">
                          <a href="client/java.html" title="Java">Java</a>
            </li>
                  <li class="none">
                          <a href="client/javascript.html" title="JavaScript">JavaScript</a>
            </li>
                  <li class="none">
                          <a href="client/perl.html" title="Perl">Perl</a>
            </li>
                  <li class="none">
                          <a href="client/curl.html" title="Curl">Curl</a>
            </li>
          </ul>
    </div>
      </div>
      <div class="navibox">
          <div class="navihead">
             <h5>Project Documentation</h5>
            </div>    
            <div class="naviitems">
    <ul>
                                                                                                                                                              <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                    <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
    </div>
      </div>
      </nav>
    <div class="main">
      <!-- Page content -->
      <div class="sect1">
<h2 id="agents">Agents</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Various agents are available for providing Jolokia
services in different environments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>WAR Agent</strong> for deployment as web application in a Jakarta EE Server.</p>
</li>
<li>
<p><strong>OSGi Agent</strong> for deployment in an OSGi container. This
agent is packaged as a bundle and requires an <a href="https://docs.osgi.org/specification/osgi.cmpn/8.1.0/service.servlet.html" class="externalLink" target="_blank" rel="noopener">OSGi CMPN Whiteboard Specification for Jakarta™ Servlet</a> extender.</p>
</li>
<li>
<p><strong>JVM Agent</strong> which can be used with any Oracle/Sun based JVM, Version 11 or later.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="war_agent">WAR Agent</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Jolokia 2.0 uses Jakarta EE 9+ (Servlet API 5+ with <code>jakarta.servlet.*</code> packages),
while Jolokia 1.x uses JavaEE/JakartaEE up to version 8 (Servlet API up to version 4 with <code>javax.servlet.*</code> packages)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The WAR agent <code>jolokia-agent-war.war</code> deploys as a regular web archive
(WAR) in a Jakarta EE server. Deployment is simple (often only a copy in a
certain directory) and the agent can be tuned like a normal web
application. Setting it up the agent servlet for secure
communication is a well known business (but specific to every
application server) and the same as for any other web archive.</p>
</div>
<div class="paragraph">
<p><code>jolokia-agent-war-unsecured.war</code> is a flavor of WAR agent without <code>&lt;security-constraint&gt;</code> elements declared in its <code>WEB-INF/web.xml</code>.</p>
</div>
<div class="paragraph">
<p>Also, this is the agent for the <a href="features/proxy.html">proxy mode</a> where it is
deployed in a simple, dedicated application server like Tomcat or
Jetty.</p>
</div>
<div class="paragraph">
<p>This is the most widely used agent. Read more about the
<a href="agent/war.html">WAR agent</a> and its installation.</p>
</div>
<div class="paragraph">
<p>The WAR agent for Jolokia 1.x has been tested to work on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JBoss 4.2.3, 5.1.0, 6.1.0, 7.0.2, 7.1.1, 8.0.0</p>
</li>
<li>
<p>Oracle WebLogic 9.2.3.0, 10.0.2.0, 10.3.6.0</p>
</li>
<li>
<p>Glassfish 2.1.1, 3.0.1, 3.1.2, 4.0.0</p>
</li>
<li>
<p>IBM Websphere 6.1.0.33, 7.0.0.11, 8.0.0.1, 8.5</p>
</li>
<li>
<p>Apache Tomcat 5.5.35, 6.0.37, 7.0.52, 8.0.3</p>
</li>
<li>
<p>Jetty 5.1.15, 6.1.26, 7.6.9, 8.1.9, 9.1.2</p>
</li>
<li>
<p>Resin 3.1.9</p>
</li>
<li>
<p>Jonas 4.10.7, 5.1.1, 5.2.1</p>
</li>
<li>
<p>Apache Geronimo 2.1.6, 2.2.1, 3.0.0</p>
</li>
<li>
<p>Spring dm Server 2.0.0.RELEASE</p>
</li>
<li>
<p>Eclipse Virgo 2.1.0</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The WAR agent for Jolokia 2.0 has been (as of December 2023) tested with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Apache Tomcat 10.1.16</p>
</li>
<li>
<p>Eclipse Jetty 11.0.18</p>
</li>
<li>
<p>WildFly 30.0.1.Final</p>
</li>
<li>
<p>Openliberty 23.0.0.11</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
One of the initial goals of <a href="https://github.com/fabric8io/docker-maven-plugin" class="externalLink" target="_blank" rel="noopener">docker-maven-plugin</a> was to test Jolokia with different application servers!
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="osgi_agent">OSGi Agent</h3>
<div class="paragraph">
<p>For an <a href="https://www.osgi.org" class="externalLink" target="_blank" rel="noopener">OSGi</a> environment an agent packaged as
an OSGi bundle is provided.</p>
</div>
<div class="paragraph">
<p>In Jolokia 1.x there were two flavors of the bundle:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>minimal bundle <code>jolokia-osgi.jar</code>, including only the
agent itself, which
requires an already installed <a href="https://www.osgi.org/javadoc/r4v42/org/osgi/service/http/HttpService.html" class="externalLink" target="_blank" rel="noopener">OSGi HTTP service</a> implementation, for example <a href="https://github.com/ops4j/org.ops4j.pax.web" class="externalLink" target="_blank" rel="noopener">Pax-Web HTTP Service</a>.</p>
</li>
<li>
<p><code>jolokia-osgi-bundle.jar</code> is an all-in-one bundle, including the
<a href="https://github.com/apache/felix-dev/tree/master/http" class="externalLink" target="_blank" rel="noopener">Felix HTTP Service implementation</a>. This bundle is useful for quick installations, where no HTTP Service is available. However, for best fitting
the OSGi philosophy, the usage of the minimal bundle is
recommended.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In Jolokia 2, there&#8217;s only single <code>jolokia-agent-osgi.jar</code> and it&#8217;s no longer using <a href="https://docs.osgi.org/specification/osgi.cmpn/7.0.0/service.http.html" class="externalLink" target="_blank" rel="noopener">OSGi CMPN HTTP Service</a>. Instead, <a href="https://docs.osgi.org/specification/osgi.cmpn/8.1.0/service.servlet.html" class="externalLink" target="_blank" rel="noopener">OSGi CMPN Whiteboard Specification for Jakarta™ Servlet</a> is used and Jolokia registers its <code>org.jolokia.server.core.osgi.OsgiAgentServlet</code> as Whiteboard service.
This approach requires existing <a href="https://docs.osgi.org/specification/osgi.cmpn/8.1.0/service.servlet.html" class="externalLink" target="_blank" rel="noopener">OSGi CMPN Whiteboard Specification for Jakarta™ Servlet</a> implementation.</p>
</div>
<div class="paragraph">
<p>The OSGi agent for Jolokia 1.x has been tested with the following containers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Felix 2.0.5, 3.0.8, 3.2.2, 4.2.1</p>
</li>
<li>
<p>Equinox 3.5.2, 3.6.1, 3.7.1, 3.8.1</p>
</li>
<li>
<p>Karaf 2.3.0</p>
</li>
<li>
<p>Virgo 2.1.0, 3.0.1</p>
</li>
<li>
<p>Knopflerfish 3.2.0</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The OSGi agent for Jolokia 2.0 has been (as of December 2023) tested with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Karaf 4.5.0 with Pax Web 10 (dev)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Read more about the
<a href="agent/osgi.html">OSGi agent</a> and its installation.</p>
</div>
</div>
<div class="sect2">
<h3 id="jvm_agent">JVM Agent</h3>
<div class="paragraph">
<p>Since Java™ 5 it is possible to start so called <em>JVM agents</em> in
advance before starting a Java™ application. This technique is used
e.g. by profiling tools for installing global classloaders in order
to instrument classes. Additionally, Java™ 6 JVM (and later) comes with a
simple embedded HTTP-Server which is used e.g. for exposing web
services with the default JAXWS implementation coming with Java™ 6.</p>
</div>
<div class="paragraph">
<p>This Jolokia agent uses the agent API and the <code>com.sun.net.httpserver.HttpServer</code> to
allow instrumenting <em>any</em> Java™ application running with a Java™ 6
VM, not only application servers.</p>
</div>
<div class="paragraph">
<p>There are two ways to install a JVM agent in Java application.</p>
</div>
<div class="paragraph">
<p>First is to use <code>-javaagent</code> command line option like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -cp target/classes:... -javaagent:\
jolokia-agent-jvm-2.1.2-javaagent.jar=port=7778 \
com.example.Main</pre>
</div>
</div>
<div class="paragraph">
<p>Second one is to use <a href="https://docs.oracle.com/en/java/javase/11/docs/api/jdk.attach/module-summary.html" class="externalLink" target="_blank" rel="noopener">JVM Attach API</a> and install an agent within running JVM process. <code>jolokia-agent-jvm-2.1.2-javaagent.jar</code> is a JAR with main class that uses this API, so we can invoke this JAR with <code>start &lt;pid&gt;</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar jolokia-agent-jvm-2.1.2-javaagent.jar start --port 7778 34870
Started Jolokia for PID 34870
http://127.0.0.1:7778/jolokia/</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Dynamic loading of agents will be removed at some point. See <a href="https://openjdk.org/jeps/451" class="externalLink" target="_blank" rel="noopener">JEP 451</a> for details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When dynamically loading a JVM agent using JDK 21 and newer, we&#8217;ll get this warning:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>WARNING: A Java agent has been loaded dynamically (jolokia-agent-jvm-2.1.2-javaagent.jar)
WARNING: If a serviceability tool is in use, please run with -XX:+EnableDynamicAgentLoading
         to hide this warning
WARNING: If a serviceability tool is not in use, please run with -Djdk.instrument.traceUsage
         for more information
WARNING: Dynamic loading of agents will be disallowed by default in a future release</pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s why the preferred method is to use <code>-javaagent</code> JVM option.</p>
</div>
<div class="paragraph">
<p>The JVM Agent for Jolokia 1.x has been tested with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Camel 2.8.1</p>
</li>
<li>
<p>ActiveMQ 5.5.0</p>
</li>
<li>
<p>Hadoop 0.20.2</p>
</li>
<li>
<p>Terracotta 3.2.1</p>
</li>
<li>
<p>HornetQ 2.2.14</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The JVM Agent for Jolokia 2.x has been (as of December 2023) tested with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Camel 4.1.0</p>
</li>
<li>
<p>ActiveMQ 6.0.1</p>
</li>
<li>
<p>ActiveMQ Artemis 2.31.2</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Read more about the <a href="agent/jvm.html">JVM agent</a> and its installation.</p>
</div>
</div>
</div>
</div>
      <!-- /Page content -->
    </div>
  </main>

  <footer class="copyright">Copyright &#169;                   2024 Roland Hu&szlig;. 
          All Rights Reserved.      
                
                 <span id="publishDate">Last Published: 2024-12-04</span>
              &nbsp;| <span id="projectVersion">Version: 2.1.3-SNAPSHOT</span>
            </footer>
</div>
</body>
</html>
